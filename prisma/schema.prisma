// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String    @id @default(uuid())
  email     String    @unique
  name      String
  password  String
  role      Role      @default(PILOT)
  isActive  Boolean   @default(false) @map("is_active")
  flightExp Int?      @default(0) @map("flight_exp")
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt
  Flight    Flight[]

  @@map("TB_USERS")
}

model Route {
  id                String    @id @default(uuid())
  origin            String
  destiny           String
  durationEstimated Int       @map("duration_estimated")
  createdAt         DateTime  @default(now())
  updatedAt         DateTime? @updatedAt
  Flight            Flight[]

  @@map("TB_ROUTES")
}

model Airline {
  id            String          @id @default(uuid())
  airline       String
  createdAt     DateTime        @default(now())
  updatedAt     DateTime?       @updatedAt
  FlightAirline FlightAirline[]

  @@map("TB_AIRLINES")
}

model Flight {
  id            String          @id @default(uuid())
  price         Decimal         @db.Money
  departureDate DateTime        @map("departure_date")
  routeId       String          @map("route_id")
  pilotId       String          @map("pilot_id")
  flightStatus  FlighStatus     @map("flight_status")
  createdAt     DateTime        @default(now())
  updatedAt     DateTime?       @updatedAt
  FlightAirline FlightAirline[]

  route Route @relation(fields: [routeId], references: [id])
  user  User  @relation(fields: [pilotId], references: [id])

  @@map("TB_FLIGHTS")
}

model FlightAirline {
  id        String    @id @default(uuid())
  flightId  String    @map("flight_id")
  airlineId String    @map("airline_id")
  flight    Flight    @relation(fields: [flightId], references: [id])
  airline   Airline   @relation(fields: [airlineId], references: [id])
  createdAt DateTime  @default(now())
  updatedAt DateTime? @updatedAt

  @@map("TB_FLIGHTS_AIRLINES")
}

enum Role {
  ADMIN
  PILOT
}

enum FlighStatus {
  BOOKED
  CANCELED
  DONE
}
